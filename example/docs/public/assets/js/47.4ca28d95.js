(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{466:function(e,s,r){"use strict";r.r(s);var n=r(3),t=Object(n.a)({},(function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("p",[e._v("       * 1、"),r("strong",[e._v("微服务的服务雪崩")]),r("br"),e._v("\n    由于微服务架构的多服务组成和网络层通信的复杂性，使得一旦一个微服务发生了故障，由于服务于服务之前的依赖性很强，会造成系统级的伤害，\n也就是级联故障，也叫雪崩效应，会导致全部系统的不可用。所以微服务需要疏通这些故障以保证整个系统的安全，从而引入了熔断机制。"),r("br"),e._v("\n    简单理解一些就是假如B服务调用了A，返回一个结果，C继续调用了B这个结果，组成一个链式调用。如果A服务调用失败，会让后面跟着的所有链式服务失败。\n此时就需要一个熔断的机制，B调用A失败的话。C就停止调用B。"),r("br")]),e._v(" "),r("p",[e._v("    * 2、"),r("strong",[e._v("Hystrix")]),r("br"),e._v("\n    Hystrix是由Netflix开源的一个延迟和容错库，用于隔离访问远程系统、\n服务或者第三方库，防止级联失败，从而提升系统的可用性、容错性与局部应用的弹性，是一个实现了超市机制和断路器模式的工具类库。"),r("br")]),e._v(" "),r("p",[e._v("       * 3、"),r("strong",[e._v("Ribbon使用熔断器")]),r("br"),e._v(" "),r("strong",[e._v("3.1、在pom文件中添加依赖")]),r("br")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v("                  <dependency>\n                      <groupId>org.springframework.cloud</groupId>\n                      <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n                  </dependency>\n")])])]),r("p",[r("strong",[e._v("3.2、启动类增加@EnableHystrix注解，开启熔断器")]),r("br")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v('          @RestController\n          public class AdminController {\n              @Autowired\n              private FeignService feignService;\n              @RequestMapping(value = "message",method = RequestMethod.GET)\n              public String showMessage(String message){\n          \n                  return feignService.showMessage(message);\n              }\n          }\n')])])]),r("p",[r("strong",[e._v("3.3、服务类")]),r("br")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v('          @Service\n          public class ProviderService {\n          \n              @Autowired\n              private RestTemplate restTemplate;\n              @HystrixCommand(fallbackMethod = "showMessageError")  // 如果出错 返回熔断方法showMessageError\n              public String showMessage(String message) {\n                  return restTemplate.getForObject("http://spring-cloud-provider/message?message=" + message, String.class);\n              }\n          \n              public String showMessageError(String message){\n                  return  String.format("your message is: %s but request bad",message);\n          \n              }\n          \n          \n          }          \n')])])]),r("p",[e._v("       * 4、"),r("strong",[e._v("feign使用熔断器")]),r("br")]),e._v(" "),r("p",[r("strong",[e._v("4.1、feign已经集成了熔断器,只需在yml中开启")]),r("br")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v("          feign:\n            hystrix:\n              enabled: true #开启Feign Hystrix 支持\n")])])]),r("p",[r("strong",[e._v("4.2、Service实现类")]),r("br")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v('          @Component\n          public class FeignServiceHystrix implements FeignService {\n          \n              @Override\n              public String showMessage(String message) {\n                  return  String.format("your message is: %s but request bad",message);\n              }\n          }\n')])])]),r("p",[r("strong",[e._v("4.3、增加fallback")]),r("br")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[e._v('          @FeignClient(value="spring-cloud-provider" ,fallback = FeignServiceHystrix.class) //服务提供者\n          public interface FeignService {\n          \n              @RequestMapping(value = "message",method = RequestMethod.GET)\n              public String showMessage(@RequestParam(value = "message") String message);\n          \n          }\n')])])]),r("p",[e._v("     本人授权"),r("a",{attrs:{href:"http://rightknights.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("维权骑士"),r("OutboundLink")],1),e._v("对我发布文章的版权行为进行追究与维权。未经本人许可，不可擅自转载或用于其他商业用途。")])])}),[],!1,null,null,null);s.default=t.exports}}]);